@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model Semester_3_Projekt.Controllers.AnalyticsController
@using Semester_3_Projekt.Classes
@{
}

<script src="js/Analytic.js" type="text/javascript"></script>
<div class="SearchContainer">
    <form id="BatchSearchForm" method="post" asp-action="Index" asp-controller="Analytics">
        <div class="SearchGrid">
            <select class="BatchChoice" id="BatchSearchChoice" name="BatchSearchChoice">
                @{
                    <option value="BatchID">Batch</option>
                    <option value="Product">Product</option>
                    <option value="Date">Date</option>
                    <option value="FromDate">Dates After</option>
                }
            </select>
        </div>
        <div class="SearchGrid">
            <input type="search" id="BatchSearchInput" name="BatchSearchInput" />
        </div>
        <div class="SearchGrid">
            <input type="submit" id="BatchSearchSubmit" name="BatchSearchSubmit" />
        </div>
    </form>
</div>
<div class="TableContainer">
    <table id="BatchTable">
        @{
            List<Batchlog> batchlogs = ViewBag.Batchlogs;
            <tr>
                @{
                    foreach (BatchRows Rows in ViewBag.BatchRows)
                    {
                        <th class="BatchCells">@Rows.Name</th>
                    }
                }
            </tr>
            if (batchlogs.Count > 0)
            {
                foreach (Batchlog batchlog in batchlogs)
                {
                    <tr>
                        @{
                            <th class="BatchCells">@batchlog.Batch.Id</th>
                            <th class="BatchCells">@batchlog.Product.pName</th>
                            <th class="BatchCells">@batchlog.Batch.Quantity</th>
                            <th class="BatchCells">@batchlog.Batch.Date</th>
                            foreach (Batch_Log log in batchlog.BatchLogs)
                            {
                                foreach (BatchRows Rows in ViewBag.BatchRows)
                                {
                                    //List<string> names = new List<string>();
                                    if (Rows.Name == log.Event_Type)// && names.Contains(Rows.Name))
                                    {
                                        if (log.Value >= 0)
                                        {
                                            <th class="BatchCells">@log.Value</th>
                                            //names.Add(Rows.Name);
                                        }/*
                                            else if (log.Description != null)
                                            {
                                                <th class="BatchCells">@log.Description</th>
                                                names.Add(Rows.Name);
                                            }*/
                                        else
                                        {
                                            <th class="BatchCells">@log.Time</th>
                                            //names.Add(Rows.Name);
                                        }
                                    }
                                }
                            }
                        }
                    </tr>
                }
            }
        }
    </table>
</div>

<style>


    .SearchContainer, .TableContainer {
        margin: 20px 0;
        padding: 15px;
        background: #f9f9f9;
        border: 1px solid #ddd;
    }

    .BatchCells, th {
        border: 1px solid #ddd;
        padding: 8px;
    }

    table {
        width: 100%;
    }

    #BatchSearchSubmit {
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
</style>
